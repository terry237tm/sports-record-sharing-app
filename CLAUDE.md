# 项目开发规范与要求 - Taro + CloudBase + CCPM 集成版

## 🌏 语言要求
**所有生成的代码注释、文档和描述信息必须使用中文**。这是客户的明确要求，必须严格遵守。

### 实施要求
- 代码注释必须使用中文
- 文档说明必须使用中文
- 错误信息和提示必须使用中文
- 函数/变量命名应使用有意义的英文名称，但注释说明必须为中文

## 📁 日志文件管理

### 日志文件存放规则
- **禁止在项目根目录生成或保留记录解决过程的 Markdown 文件**（如 DEPRECATION_FIXES_SUMMARY.md）
- **所有此类日志必须输出到 `docs/claude-logs/` 目录**
- **使用正确的日期前缀和英文文件名**

### 命名格式
```
docs/claude-logs/YYYY-MM-DD-description.md
```

## 🤖 CCPM 集成配置

### 子代理使用规范
**为了优化上下文使用和性能，必须使用指定的子代理：**

1. **file-analyzer 子代理** - 用于读取文件时
   - 专门提取和总结文件中的关键信息
   - 提供简洁、可操作的分析结果
   - 显著减少上下文使用量

2. **code-analyzer 子代理** - 用于搜索代码、分析代码、研究错误或追踪逻辑流时
   - 专业的代码分析和逻辑追踪
   - 漏洞检测和代码质量分析
   - 提供简洁、可操作的分析结果

3. **test-runner 子代理** - 用于运行测试和分析测试结果时
   - 完整的测试输出捕获用于调试
   - 保持主对话清洁和专注
   - 优化上下文使用
   - 正确显示所有问题
   - 无中断的工作流

### 开发哲学

#### 错误处理
- **快速失败** - 关键配置错误立即失败（缺少文本模型）
- **记录并继续** - 可选功能失败时记录并继续（提取模型）
- **优雅降级** - 外部服务不可用时优雅处理
- **用户友好消息** - 通过弹性层提供友好错误信息

#### 测试原则
- 始终使用 test-runner 代理执行测试
- 绝不使用模拟服务
- 在完成当前测试前不进入下一个测试
- 测试失败时先检查测试结构是否正确，再决定是否重构代码库
- 测试应该详细，以便用于调试

#### 语气和行为
- 欢迎批评，指出错误或可能有误的地方
- 如果有更好的方法，请提出建议
- 如果存在相关的标准或约定，请指出
- 保持怀疑态度
- 保持简洁
- 简短的总结可以，但不要给出详细的分解，除非我们正在讨论计划的细节
- 不要奉承，除非特别要求判断，否则不要给予赞扬

## 🧪 TDD 开发模式

### 核心原则
**我们必须严格遵守 TDD（测试驱动开发）开发模式**。

### 禁止行为
- ❌ **不得通过删除失败的测试文件来实现测试套件通过**
- ❌ **不得通过简化测试来欺骗自己相信测试通过**
- ❌ **不得忽视或跳过失败的测试**

### 正确做法
- ✅ **先写测试，后实现功能**
- ✅ **确保所有测试都真正通过**
- ✅ **修复失败的测试，而不是删除它们**
- ✅ **保持测试的完整性和有效性**

### 开发流程
1. 编写测试用例（红色）
2. 运行测试，确认失败
3. 编写最小代码使测试通过（绿色）
4. 重构代码（重构）
5. 重复以上步骤

## 🔧 技术规范

### 代码质量
- 遵循 SOLID 原则
- 保持代码简洁清晰
- 避免过度工程化
- 优先解决当前需求

### 文件组织
- 合理规划文件结构
- 使用描述性命名
- 遵循项目现有约定
- 保持工作空间整洁

### Git 工作流
- 使用功能分支
- 频繁提交，提交信息有意义
- 在风险操作前创建还原点
- 保持干净的提交历史

## ⚠️ 质量控制

### 开发前检查
- [ ] 理解需求
- [ ] 规划实现方案  
- [ ] 识别并行操作机会
- [ ] 评估资源使用情况

### 开发后验证
- [ ] 运行测试套件
- [ ] 执行代码检查（lint）
- [ ] 执行类型检查（typecheck）
- [ ] 验证功能完整性

### 任务管理
- 使用 TodoWrite 工具跟踪复杂任务
- 及时标记任务状态
- 保持任务描述的清晰性
- 定期检査进度

## 🎯 成功标准
- 所有测试真正通过
- 代码符合质量标准
- 文档使用中文
- 日志文件正确归档
- 功能完整实现
- CCPM 子代理正确使用

## 📚 CCPM 相关资源
- [CCPM 命令参考](./COMMANDS.md)
- [CCPM 代理说明](./AGENTS.md)
- [CCPM 完整文档](./README.md)